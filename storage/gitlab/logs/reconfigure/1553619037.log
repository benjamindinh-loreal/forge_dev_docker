# Logfile created on 2019-03-26 16:50:37 +0000 by logger.rb/61378
[2019-03-26T16:50:37+00:00] INFO: Started chef-zero at chefzero://localhost:1 with repository at /opt/gitlab/embedded
  One version per cookbook

[2019-03-26T16:50:37+00:00] INFO: *** Chef 13.6.4 ***
[2019-03-26T16:50:37+00:00] INFO: Platform: x86_64-linux
[2019-03-26T16:50:37+00:00] INFO: Chef-client pid: 21
[2019-03-26T16:50:37+00:00] INFO: The plugin path /etc/chef/ohai/plugins does not exist. Skipping...
[2019-03-26T16:50:38+00:00] WARN: Plugin Network: unable to detect ipaddress
[2019-03-26T16:50:39+00:00] INFO: Setting the run_list to ["recipe[gitlab]"] from CLI options
[2019-03-26T16:50:39+00:00] INFO: Run List is [recipe[gitlab]]
[2019-03-26T16:50:39+00:00] INFO: Run List expands to [gitlab]
[2019-03-26T16:50:39+00:00] INFO: Starting Chef Run for d6e9c11282d1
[2019-03-26T16:50:39+00:00] INFO: Running start handlers
[2019-03-26T16:50:39+00:00] INFO: Start handlers complete.
[2019-03-26T16:50:40+00:00] INFO: Loading cookbooks [gitlab@0.0.1, package@0.1.0, postgresql@0.1.0, redis@0.1.0, registry@0.1.0, mattermost@0.1.0, consul@0.1.0, gitaly@0.1.0, letsencrypt@0.1.0, nginx@0.1.0, runit@4.3.0, acme@3.1.0, crond@0.1.0, compat_resource@12.19.1]
[2019-03-26T16:50:45+00:00] INFO: Skipped selecting an init system because it was explicitly disabled
[2019-03-26T16:50:45+00:00] INFO: The plugin path /etc/chef/ohai/plugins does not exist. Skipping...
[2019-03-26T16:50:46+00:00] INFO: execute[/opt/gitlab/embedded/service/gitlab-shell/bin/gitlab-keys check-permissions] ran successfully
[2019-03-26T16:50:47+00:00] INFO: link[/opt/gitlab/service/redis] created
[2019-03-26T16:50:47+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start redis], 19 attempt(s) left
[2019-03-26T16:50:50+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start redis], 18 attempt(s) left
[2019-03-26T16:50:52+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start redis] ran successfully
[2019-03-26T16:50:52+00:00] INFO: link[/opt/gitlab/service/gitaly] created
[2019-03-26T16:50:53+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start gitaly], 19 attempt(s) left
[2019-03-26T16:50:55+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start gitaly], 18 attempt(s) left
[2019-03-26T16:50:59+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start gitaly] ran successfully
[2019-03-26T16:50:59+00:00] INFO: link[/opt/gitlab/service/postgresql] created
[2019-03-26T16:51:01+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start postgresql], 19 attempt(s) left
[2019-03-26T16:51:04+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start postgresql] ran successfully
[2019-03-26T16:51:04+00:00] INFO: link[/opt/gitlab/service/unicorn] created
[2019-03-26T16:51:05+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start unicorn], 19 attempt(s) left
[2019-03-26T16:51:07+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start unicorn], 18 attempt(s) left
[2019-03-26T16:51:11+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start unicorn] ran successfully
[2019-03-26T16:51:11+00:00] INFO: link[/opt/gitlab/service/sidekiq] created
[2019-03-26T16:51:12+00:00] INFO: Retrying execution of execute[/opt/gitlab/bin/gitlab-ctl start sidekiq], 19 attempt(s) left
[2019-03-26T16:51:15+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start sidekiq] ran successfully
[2019-03-26T16:51:15+00:00] INFO: link[/opt/gitlab/service/gitlab-workhorse] created
[2019-03-26T16:51:15+00:00] INFO: link[/opt/gitlab/service/nginx] created
[2019-03-26T16:51:17+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start nginx] ran successfully
[2019-03-26T16:51:17+00:00] INFO: link[/opt/gitlab/service/logrotate] created
[2019-03-26T16:51:22+00:00] INFO: ruby_block[wait for logrotate service socket] called
[2019-03-26T16:51:24+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start logrotate] ran successfully
[2019-03-26T16:51:24+00:00] INFO: file[/var/opt/gitlab/bootstrapped] created file /var/opt/gitlab/bootstrapped
[2019-03-26T16:51:24+00:00] INFO: file[/var/opt/gitlab/bootstrapped] updated file contents /var/opt/gitlab/bootstrapped
[2019-03-26T16:51:24+00:00] INFO: file[/var/opt/gitlab/bootstrapped] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: file[/var/opt/gitlab/bootstrapped] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: file[/var/opt/gitlab/bootstrapped] mode changed to 600
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] created file /opt/gitlab/etc/gitlab-healthcheck-rc
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] updated file contents /opt/gitlab/etc/gitlab-healthcheck-rc
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: directory[/var/opt/gitlab/gitlab-monitor] created directory /var/opt/gitlab/gitlab-monitor
[2019-03-26T16:51:24+00:00] INFO: directory[/var/opt/gitlab/gitlab-monitor] owner changed to 998
[2019-03-26T16:51:24+00:00] INFO: directory[/var/opt/gitlab/gitlab-monitor] mode changed to 755
[2019-03-26T16:51:24+00:00] INFO: directory[/var/log/gitlab/gitlab-monitor] created directory /var/log/gitlab/gitlab-monitor
[2019-03-26T16:51:24+00:00] INFO: directory[/var/log/gitlab/gitlab-monitor] owner changed to 998
[2019-03-26T16:51:24+00:00] INFO: directory[/var/log/gitlab/gitlab-monitor] mode changed to 700
[2019-03-26T16:51:24+00:00] INFO: template[/var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml] created file /var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml
[2019-03-26T16:51:24+00:00] INFO: template[/var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml] updated file contents /var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml
[2019-03-26T16:51:24+00:00] INFO: template[/var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml] owner changed to 998
[2019-03-26T16:51:24+00:00] INFO: template[/var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml] mode changed to 600
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor] created directory /opt/gitlab/sv/gitlab-monitor
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor] mode changed to 755
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/run] created file /opt/gitlab/sv/gitlab-monitor/run
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/run] updated file contents /opt/gitlab/sv/gitlab-monitor/run
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/run] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/run] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/run] mode changed to 755
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log] created directory /opt/gitlab/sv/gitlab-monitor/log
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log] mode changed to 755
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log/main] created directory /opt/gitlab/sv/gitlab-monitor/log/main
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log/main] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log/main] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/log/main] mode changed to 755
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/log/run] created file /opt/gitlab/sv/gitlab-monitor/log/run
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/log/run] updated file contents /opt/gitlab/sv/gitlab-monitor/log/run
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/log/run] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/log/run] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/log/run] mode changed to 755
[2019-03-26T16:51:24+00:00] INFO: template[/var/log/gitlab/gitlab-monitor/config] created file /var/log/gitlab/gitlab-monitor/config
[2019-03-26T16:51:24+00:00] INFO: template[/var/log/gitlab/gitlab-monitor/config] updated file contents /var/log/gitlab/gitlab-monitor/config
[2019-03-26T16:51:24+00:00] INFO: template[/var/log/gitlab/gitlab-monitor/config] owner changed to 0
[2019-03-26T16:51:24+00:00] INFO: template[/var/log/gitlab/gitlab-monitor/config] group changed to 0
[2019-03-26T16:51:24+00:00] INFO: template[/var/log/gitlab/gitlab-monitor/config] mode changed to 644
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/env] created directory /opt/gitlab/sv/gitlab-monitor/env
[2019-03-26T16:51:24+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/env] owner changed to 0
[2019-03-26T16:51:25+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/env] group changed to 0
[2019-03-26T16:51:25+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/env] mode changed to 755
[2019-03-26T16:51:25+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/control] created directory /opt/gitlab/sv/gitlab-monitor/control
[2019-03-26T16:51:25+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/control] owner changed to 0
[2019-03-26T16:51:25+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/control] group changed to 0
[2019-03-26T16:51:25+00:00] INFO: directory[/opt/gitlab/sv/gitlab-monitor/control] mode changed to 755
[2019-03-26T16:51:25+00:00] INFO: link[/opt/gitlab/init/gitlab-monitor] created
[2019-03-26T16:51:25+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/run] sending run action to ruby_block[restart_service] (delayed)
[2019-03-26T16:51:25+00:00] INFO: template[/opt/gitlab/sv/gitlab-monitor/log/run] sending create action to ruby_block[restart_log_service] (delayed)
[2019-03-26T16:51:25+00:00] INFO: link[/opt/gitlab/service/gitlab-monitor] created
[2019-03-26T16:51:29+00:00] INFO: ruby_block[wait for gitlab-monitor service socket] called
[2019-03-26T16:51:30+00:00] INFO: ruby_block[restart_log_service] called
[2019-03-26T16:51:30+00:00] INFO: template[/var/log/gitlab/gitlab-monitor/config] sending create action to ruby_block[reload_log_service] (delayed)
[2019-03-26T16:51:31+00:00] INFO: ruby_block[reload_log_service] called
[2019-03-26T16:51:35+00:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start gitlab-monitor] ran successfully
[2019-03-26T16:51:35+00:00] INFO: directory[/var/log/gitlab/redis-exporter] created directory /var/log/gitlab/redis-exporter
[2019-03-26T16:51:35+00:00] INFO: directory[/var/log/gitlab/redis-exporter] owner changed to 997
[2019-03-26T16:51:35+00:00] INFO: directory[/var/log/gitlab/redis-exporter] mode changed to 700
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/etc/redis-exporter/env] created directory /opt/gitlab/etc/redis-exporter/env
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/etc/redis-exporter/env] owner changed to 997
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/etc/redis-exporter/env] mode changed to 700
[2019-03-26T16:51:35+00:00] INFO: file[/opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR] created file /opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR
[2019-03-26T16:51:35+00:00] INFO: file[/opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter] created directory /opt/gitlab/sv/redis-exporter
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter] mode changed to 755
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] created file /opt/gitlab/sv/redis-exporter/run
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] updated file contents /opt/gitlab/sv/redis-exporter/run
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] mode changed to 755
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] created directory /opt/gitlab/sv/redis-exporter/log
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] mode changed to 755
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] created directory /opt/gitlab/sv/redis-exporter/log/main
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] mode changed to 755
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] created file /opt/gitlab/sv/redis-exporter/log/run
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] updated file contents /opt/gitlab/sv/redis-exporter/log/run
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] mode changed to 755
[2019-03-26T16:51:35+00:00] INFO: template[/var/log/gitlab/redis-exporter/config] created file /var/log/gitlab/redis-exporter/config
[2019-03-26T16:51:35+00:00] INFO: template[/var/log/gitlab/redis-exporter/config] updated file contents /var/log/gitlab/redis-exporter/config
[2019-03-26T16:51:35+00:00] INFO: template[/var/log/gitlab/redis-exporter/config] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: template[/var/log/gitlab/redis-exporter/config] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: template[/var/log/gitlab/redis-exporter/config] mode changed to 644
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] created directory /opt/gitlab/sv/redis-exporter/env
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] mode changed to 755
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] created directory /opt/gitlab/sv/redis-exporter/control
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] owner changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] group changed to 0
[2019-03-26T16:51:35+00:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] mode changed to 755
[2019-03-26T16:51:35+00:00] INFO: link[/opt/gitlab/init/redis-exporter] created
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] sending run action to ruby_block[restart_service] (delayed)
[2019-03-26T16:51:35+00:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] sending create action to ruby_block[restart_log_service] (delayed)
[2019-03-26T16:51:35+00:00] INFO: link[/opt/gitlab/service/redis-exporter] created
[2019-03-26T16:51:35+00:00] INFO: Running queued delayed notifications before re-raising exception
[2019-03-26T16:51:35+00:00] INFO: template[/var/log/gitlab/redis-exporter/config] sending create action to ruby_block[reload_log_service] (delayed)
[2019-03-26T16:51:36+00:00] INFO: Running queued delayed notifications before re-raising exception
[2019-03-26T16:51:36+00:00] INFO: Running queued delayed notifications before re-raising exception
[2019-03-26T16:51:36+00:00] INFO: template[/var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml] sending restart action to service[gitlab-monitor] (delayed)
[2019-03-26T16:51:36+00:00] INFO: env_dir[/opt/gitlab/etc/redis-exporter/env] sending restart action to service[redis-exporter] (delayed)
[2019-03-26T16:51:36+00:00] ERROR: Running exception handlers
[2019-03-26T16:51:36+00:00] ERROR: Exception handlers complete
[2019-03-26T16:51:36+00:00] FATAL: Stacktrace dumped to /opt/gitlab/embedded/cookbooks/cache/chef-stacktrace.out
[2019-03-26T16:51:36+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
[2019-03-26T16:51:36+00:00] FATAL: Chef::Exceptions::MultipleFailures: Multiple failures occurred:
* Chef::Exceptions::MultipleFailures occurred in chef run: Multiple failures occurred:
* Errno::ENOMEM occurred in delayed notification: ruby_block[restart_log_service] (/opt/gitlab/embedded/cookbooks/cache/cookbooks/runit/libraries/provider_runit_service.rb line 69) had an error: Errno::ENOMEM: ruby_block[wait for redis-exporter service socket] (/opt/gitlab/embedded/cookbooks/cache/cookbooks/runit/libraries/provider_runit_service.rb line 253) had an error: Errno::ENOMEM: Cannot allocate memory - fork(2)
* Errno::ENOMEM occurred in delayed notification: ruby_block[reload_log_service] (/opt/gitlab/embedded/cookbooks/cache/cookbooks/runit/libraries/provider_runit_service.rb line 77) had an error: Errno::ENOMEM: ruby_block[wait for redis-exporter service socket] (/opt/gitlab/embedded/cookbooks/cache/cookbooks/runit/libraries/provider_runit_service.rb line 253) had an error: Errno::ENOMEM: Cannot allocate memory - fork(2)

* Errno::ENOMEM occurred in delayed notification: service[gitlab-monitor] (dynamically defined) had an error: Errno::ENOMEM: Cannot allocate memory - fork(2)
* Errno::ENOMEM occurred in delayed notification: service[redis-exporter] (dynamically defined) had an error: Errno::ENOMEM: Cannot allocate memory - fork(2)

